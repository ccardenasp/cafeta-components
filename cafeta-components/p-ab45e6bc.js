import{g as t,C as s,i,t as e,a as n,P as r,I as a,b as h,c as o,T as c,d as u,e as l,f as M,p as g,h as d,j as w,k as A,l as j,m as L,n as D,R as y,o as N,W as f,q as I,M as x,r as b,s as T,V as k,u as m,F as E,K as p,v as C,w as S,B as _,x as v,y as z,z as O,A as P,D as Q}from"./p-dd9bf309.js";
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function U(s){return t=>{t.on(`attribute:${s}:image`,i)};function i(s,i,e){if(!e.consumable.consume(i.item,s.name))return;const n=e.writer,r=e.mapper.toViewElement(i.item),a=t(r);n.setAttribute(i.attributeKey,i.attributeNewValue||"",a)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Y extends s{refresh(){this.isEnabled=i(this.editor.model)}execute(t){const s=this.editor.model;for(const i of e(t.source))n(s,{src:i})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class V extends r{static get pluginName(){return"ImageEditing"}init(){const s=this.editor,i=s.model.schema,e=s.t,n=s.conversion;s.editing.view.addObserver(a),i.register("image",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),n.for("dataDowncast").elementToElement({model:"image",view:(t,{writer:s})=>Z(s)}),n.for("editingDowncast").elementToElement({model:"image",view:(t,{writer:s})=>h(Z(s),s,e("image widget"))}),n.for("downcast").add(U("src")).add(U("alt")).add(function(){return t=>{t.on("attribute:srcset:image",s)};function s(s,i,e){if(!e.consumable.consume(i.item,s.name))return;const n=e.writer,r=e.mapper.toViewElement(i.item),a=t(r);if(null===i.attributeNewValue){const t=i.attributeOldValue;t.data&&(n.removeAttribute("srcset",a),n.removeAttribute("sizes",a),t.width&&n.removeAttribute("width",a))}else{const t=i.attributeNewValue;t.data&&(n.setAttribute("srcset",t.data,a),n.setAttribute("sizes","100vw",a),t.width&&n.setAttribute("width",t.width,a))}}}()),n.for("upcast").elementToElement({view:{name:"img",attributes:{src:!0}},model:(t,{writer:s})=>s.createElement("image",{src:t.getAttribute("src")})}).attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:t=>{const s={data:t.getAttribute("srcset")};return t.hasAttribute("width")&&(s.width=t.getAttribute("width")),s}}}).add(
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function(){return t=>{t.on("element:figure",s)};function s(s,i,e){if(!e.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const n=t(i.viewItem);if(!n||!n.hasAttribute("src")||!e.consumable.test(n,{name:!0}))return;const r=function(t){const s=t.next();return s.done?null:s.value}(e.convertItem(n,i.modelCursor).modelRange.getItems());r&&(e.convertChildren(i.viewItem,r),e.updateConversionResult(r,i))}}()),s.commands.add("imageInsert",new Y(s))}}function Z(t){const s=t.createEmptyElement("img"),i=t.createContainerElement("figure",{class:"image"});return t.insert(t.createPositionAt(i,0),s),i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const B=[o("arrowUp"),o("arrowRight"),o("arrowDown"),o("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let ut=112;ut<=135;ut++)B.push(ut);const H=["before","after"],W=(new DOMParser).parseFromString("data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMTAgOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOS4wNTUuMjYzdjMuOTcyaC02Ljc3TTEgNC4yMTZsMi0yLjAzOG0tMiAybDIgMi4wMzgiLz48L3N2Zz4=","image/svg+xml").firstChild;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class F extends r{static get pluginName(){return"WidgetTypeAround"}constructor(t){super(t),this._currentFakeCaretModelElement=null}init(){const t=this.editor,s=t.editing.view;this.on("change:isEnabled",(i,e,n)=>{s.change(t=>{for(const i of s.document.roots)n?t.removeClass("ck-widget__type-around_disabled",i):t.addClass("ck-widget__type-around_disabled",i)}),n||t.model.change(t=>{t.removeSelectionAttribute(c)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(t,s){const i=this.editor,e=i.editing.view;i.execute("insertParagraph",{position:i.model.createPositionAt(t,s)}),e.focus(),e.scrollToTheSelection()}_listenToIfEnabled(t,s,i,e){this.listenTo(t,s,(...t)=>{this.isEnabled&&i(...t)},e)}_insertParagraphAccordingToFakeCaretPosition(){const t=this.editor.model.document.selection,s=u(t);if(!s)return!1;const i=t.getSelectedElement();return this._insertParagraph(i,s),!0}_enableTypeAroundUIInjection(){const t=this.editor,s=t.model.schema,i=t.locale.t,e={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};t.editing.downcastDispatcher.on("insert",(t,i,n)=>{const r=n.mapper.toViewElement(i.item);l(r,i.item,s)&&function(t,s,i){const e=t.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},(function(t){const i=this.toDomElement(t);return function(t,s){for(const i of H){const e=new D({tag:"div",attributes:{class:["ck","ck-widget__type-around__button","ck-widget__type-around__button_"+i],title:s[i]},children:[t.ownerDocument.importNode(W,!0)]});t.appendChild(e.render())}}(i,s),function(t){const s=new D({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});t.appendChild(s.render())}(i),i}));t.insert(t.createPositionAt(i,"end"),e)}(n.writer,e,r)},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const t=this.editor,s=t.model,i=s.document.selection,e=s.schema;function n(t){return"ck-widget_type-around_show-fake-caret_"+t}this._listenToIfEnabled(t.editing.view.document,"keydown",(t,s)=>{M(s.keyCode)&&this._handleArrowKeyPress(t,s)},{priority:g.get("high")+10}),this._listenToIfEnabled(i,"change:range",(s,i)=>{i.directChange&&t.model.change(t=>{t.removeSelectionAttribute(c)})}),this._listenToIfEnabled(s.document,"change:data",()=>{const s=i.getSelectedElement();if(s){const i=t.editing.mapper.toViewElement(s);if(l(i,s,e))return}t.model.change(t=>{t.removeSelectionAttribute(c)})}),this._listenToIfEnabled(t.editing.downcastDispatcher,"selection",(t,s,i)=>{const r=i.writer;if(this._currentFakeCaretModelElement){const t=i.mapper.toViewElement(this._currentFakeCaretModelElement);t&&(r.removeClass(H.map(n),t),this._currentFakeCaretModelElement=null)}const a=s.selection.getSelectedElement();if(!a)return;const h=i.mapper.toViewElement(a);if(!l(h,a,e))return;const o=u(s.selection);o&&(r.addClass(n(o),h),this._currentFakeCaretModelElement=a)}),this._listenToIfEnabled(t.ui.focusTracker,"change:isFocused",(s,i,e)=>{e||t.model.change(t=>{t.removeSelectionAttribute(c)})})}_handleArrowKeyPress(t,s){const i=this.editor,e=i.model,n=e.document.selection,r=e.schema,a=i.editing.view,h=j(s.keyCode,i.locale.contentLanguageDirection),o=a.document.selection.getSelectedElement(),c=i.editing.mapper.toModelElement(o);let u;l(o,c,r)?u=this._handleArrowKeyPressOnSelectedWidget(h):n.isCollapsed&&(u=this._handleArrowKeyPressWhenSelectionNextToAWidget(h)),u&&(s.preventDefault(),t.stop())}_handleArrowKeyPressOnSelectedWidget(t){const s=this.editor.model,i=u(s.document.selection);return s.change(s=>i?i!==(t?"after":"before")&&(s.removeSelectionAttribute(c),!0):(s.setSelectionAttribute(c,t?"after":"before"),!0))}_handleArrowKeyPressWhenSelectionNextToAWidget(t){const s=this.editor,i=s.model,e=i.schema,n=s.plugins.get("Widget"),r=n._getObjectElementNextToSelection(t),a=s.editing.mapper.toViewElement(r);return!!l(a,r,e)&&(i.change(s=>{n._setSelectionOverElement(r),s.setSelectionAttribute(c,t?"before":"after")}),!0)}_enableInsertingParagraphsOnButtonClick(){const t=this.editor,s=t.editing.view;this._listenToIfEnabled(s.document,"mousedown",(i,e)=>{const n=d(e.domTarget);if(!n)return;const r=w(n),a=A(n,s.domConverter),h=t.editing.mapper.toModelElement(a);this._insertParagraph(h,r),e.preventDefault(),i.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const t=this.editor,s=t.editing.view;this._listenToIfEnabled(s.document,"enter",(i,e)=>{const n=s.document.selection.getSelectedElement(),r=t.editing.mapper.toModelElement(n),a=t.model.schema;let h;this._insertParagraphAccordingToFakeCaretPosition()?h=!0:l(n,r,a)&&(this._insertParagraph(r,e.isSoft?"before":"after"),h=!0),h&&(e.preventDefault(),i.stop())})}_enableInsertingParagraphsOnTypingKeystroke(){const t=[L.enter,L.delete,L.backspace];this._listenToIfEnabled(this.editor.editing.view.document,"keydown",(s,i)=>{var e;t.includes(i.keyCode)||(e=i).ctrlKey||B.includes(e.keyCode)||this._insertParagraphAccordingToFakeCaretPosition()},{priority:g.get("high")+1})}_enableDeleteIntegration(){const t=this.editor,s=t.model,i=s.schema;this._listenToIfEnabled(t.editing.view.document,"delete",(e,n)=>{const r=u(s.document.selection);if(!r)return;const a=n.direction,h=s.document.selection.getSelectedElement(),o="forward"==a;if("before"===r===o)t.execute("delete",{selection:s.createSelection(h,"on")});else{const e=i.getNearestSelectionRange(s.createPositionAt(h,r),a);if(e)if(e.isCollapsed){const n=s.createSelection(e.start);if(s.modifySelection(n,{direction:a}),n.focus.isEqual(e.start)){const t=function(t,s){let i=s;for(const e of s.getAncestors({parentFirst:!0})){if(e.childCount>1||t.isLimit(e))break;i=e}return i}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */(i,e.start.parent);s.deleteContent(s.createSelection(t,"on"),{doNotAutoparagraph:!0})}else s.change(s=>{s.setSelection(e),t.execute(o?"forwardDelete":"delete")})}else s.change(s=>{s.setSelection(e),t.execute(o?"forwardDelete":"delete")})}n.preventDefault(),e.stop()},{priority:g.get("high")+1})}_enableInsertContentIntegration(){const t=this.editor.model,s=t.document.selection;this._listenToIfEnabled(this.editor.model,"insertContent",(i,[e,n])=>{if(n&&!n.is("documentSelection"))return;const r=u(s);return r?(i.stop(),t.change(i=>{const n=s.getSelectedElement(),a=t.createPositionAt(n,r),h=i.createSelection(a),o=t.insertContent(e,h);return i.setSelection(h),o})):void 0},{priority:"high"})}}function J(t,s,i){const e=t.schema,n=t.createRangeIn(s.root),r="forward"==i?"elementStart":"elementEnd";for(const{previousPosition:a,item:h,type:o}of n.getWalker({startPosition:s,direction:i})){if(e.isLimit(h)&&!e.isInline(h))return a;if(o==r&&e.isBlock(h))return null}return null}function G(t,s,i){const e="backward"==i?s.end:s.start;if(t.checkChild(e,"$text"))return e;for(const{nextPosition:n}of s.getWalker({direction:i}))if(t.checkChild(n,"$text"))return n}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class R extends r{static get pluginName(){return"Widget"}static get requires(){return[F]}init(){const t=this.editor.editing.view,s=t.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(t,s,i)=>{this._clearPreviouslySelectedWidgets(i.writer);const e=i.writer,n=e.document.selection,r=n.getSelectedElement();let a=null;for(const c of n.getRanges())for(const t of c){const s=t.item;N(s)&&(h=s,!(o=a)||!Array.from(h.getAncestors()).includes(o))&&(e.addClass(f,s),this._previouslySelected.add(s),a=s,s==r&&e.setSelection(n.getRanges(),{fake:!0,label:I(r)}))}var h,o;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */},{priority:"low"}),t.addObserver(x),this.listenTo(s,"mousedown",(...t)=>this._onMousedown(...t)),this.listenTo(s,"keydown",(...t)=>{this._handleSelectionChangeOnArrowKeyPress(...t)},{priority:"high"}),this.listenTo(s,"keydown",(...t)=>{this._preventDefaultOnArrowKeyPress(...t)},{priority:g.get("high")-20}),this.listenTo(s,"keydown",function(t){const s=t.model;return(i,e)=>{const n=e.keyCode==L.arrowdown,r=e.shiftKey,a=s.document.selection;if(e.keyCode!=L.arrowup&&!n)return;const h=n;if(r&&function(t,s){return!t.isCollapsed&&t.isBackward==s}(a,h))return;const o=function(t,s,i){const e=t.model;if(i){const t=s.isCollapsed?s.focus:s.getLastPosition(),i=J(e,t,"forward");if(!i)return null;const n=e.createRange(t,i),r=G(e.schema,n,"backward");return r&&t.isBefore(r)?e.createRange(t,r):null}{const t=s.isCollapsed?s.focus:s.getFirstPosition(),i=J(e,t,"backward");if(!i)return null;const n=e.createRange(i,t),r=G(e.schema,n,"forward");return r&&t.isAfter(r)?e.createRange(r,t):null}}(t,a,h);o&&!o.isCollapsed&&function(t,s,i){const e=t.model,n=t.view.domConverter;if(i){const t=e.createSelection(s.start);e.modifySelection(t),t.focus.isAtEnd||s.start.isEqual(t.focus)||(s=e.createRange(t.focus,s.end))}const r=t.mapper.toViewRange(s),a=n.viewRangeToDom(r),h=y.getDomRangeRects(a);let o;for(const c of h)if(void 0!==o){if(Math.round(c.top)>=o)return!1;o=Math.max(o,Math.round(c.bottom))}else o=Math.round(c.bottom);return!0}(t,o,h)&&(s.change(t=>{const i=h?o.end:o.start;if(r){const e=s.createSelection(a.anchor);e.setFocus(i),t.setSelection(e)}else t.setSelection(i)}),i.stop(),e.preventDefault(),e.stopPropagation())}}(this.editor.editing)),this.listenTo(s,"delete",(t,s)=>{this._handleDelete("forward"==s.direction)&&(s.preventDefault(),t.stop())},{priority:"high"})}_onMousedown(t,s){const i=this.editor,e=i.editing.view,n=e.document;let r=s.target;if(function(t){for(;t;){if(t.is("editableElement")&&!t.is("rootElement"))return!0;if(N(t))return!1;t=t.parent}return!1}(r)){if((b.isSafari||b.isGecko)&&s.domEvent.detail>=3){const t=i.editing.mapper,e=r.is("attributeElement")?r.findAncestor(t=>!t.is("attributeElement")):r,n=t.toModelElement(e);s.preventDefault(),this.editor.model.change(t=>{t.setSelection(n,"in")})}return}if(!N(r)&&(r=r.findAncestor(N),!r))return;s.preventDefault(),n.isFocused||e.focus();const a=i.editing.mapper.toModelElement(r);this._setSelectionOverElement(a)}_handleSelectionChangeOnArrowKeyPress(t,s){const i=s.keyCode;if(!M(i))return;const e=this.editor.model,n=e.schema,r=e.document.selection,a=r.getSelectedElement(),h=j(i,this.editor.locale.contentLanguageDirection);if(a&&n.isObject(a)){const i=h?r.getLastPosition():r.getFirstPosition(),a=n.getNearestSelectionRange(i,h?"forward":"backward");return void(a&&(e.change(t=>{t.setSelection(a)}),s.preventDefault(),t.stop()))}if(!r.isCollapsed)return;const o=this._getObjectElementNextToSelection(h);o&&n.isObject(o)&&(this._setSelectionOverElement(o),s.preventDefault(),t.stop())}_preventDefaultOnArrowKeyPress(t,s){if(!M(s.keyCode))return;const i=this.editor.model,e=i.schema,n=i.document.selection.getSelectedElement();n&&e.isObject(n)&&(s.preventDefault(),t.stop())}_handleDelete(t){if(this.editor.isReadOnly)return;const s=this.editor.model.document.selection;if(!s.isCollapsed)return;const i=this._getObjectElementNextToSelection(t);return i?(this.editor.model.change(t=>{let e=s.anchor.parent;for(;e.isEmpty;){const s=e;e=s.parent,t.remove(s)}this._setSelectionOverElement(i)}),!0):void 0}_setSelectionOverElement(t){this.editor.model.change(s=>{s.setSelection(s.createRangeOn(t))})}_getObjectElementNextToSelection(t){const s=this.editor.model,i=s.schema,e=s.createSelection(s.document.selection);s.modifySelection(e,{direction:t?"forward":"backward"});const n=t?e.focus.nodeBefore:e.focus.nodeAfter;return n&&i.isObject(n)?n:null}_clearPreviouslySelectedWidgets(t){for(const s of this._previouslySelected)t.removeClass(f,s);this._previouslySelected.clear()}}class K extends s{refresh(){const t=this.editor.model.document.selection.getSelectedElement();this.isEnabled=T(t),this.value=!(!T(t)||!t.hasAttribute("alt"))&&t.getAttribute("alt")}execute(t){const s=this.editor.model,i=s.document.selection.getSelectedElement();s.change(s=>{s.setAttribute("alt",t.newValue,i)})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class q extends r{static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new K(this.editor))}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $ extends k{constructor(t){super(t),this.set("text"),this.set("for"),this.id="ck-editor__label_"+m();const s=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:s.to("for")},children:[{text:s.to("text")}]})}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class X extends k{constructor(t,s){super(t);const i="ck-labeled-field-view-"+m(),e="ck-labeled-field-view-status-"+m();this.fieldView=s(this,i,e),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(e),this.bind("_statusText").to(this,"errorText",this,"infoText",(t,s)=>t||s);const n=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",n.to("class"),n.if("isEnabled","ck-disabled",t=>!t),n.if("isEmpty","ck-labeled-field-view_empty"),n.if("isFocused","ck-labeled-field-view_focused"),n.if("placeholder","ck-labeled-field-view_placeholder"),n.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(t){const s=new $(this.locale);return s.for=t,s.bind("text").to(this,"label"),s}_createStatusView(t){const s=new k(this.locale),i=this.bindTemplate;return s.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",t=>!t)],id:t,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),s}focus(){this.fieldView.focus()}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class tt extends k{constructor(t){super(t),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new E,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const s=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",s.if("isFocused","ck-input_focused"),s.if("isEmpty","ck-input-text_empty"),s.if("hasError","ck-error")],id:s.to("id"),placeholder:s.to("placeholder"),readonly:s.to("isReadOnly"),"aria-invalid":s.if("hasError",!0),"aria-describedby":s.to("ariaDescribedById")},on:{input:s.to("input"),change:s.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(t,s,i)=>{this._setDomElementValue(i),this._updateIsEmpty()})}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=!this.element.value}_setDomElementValue(t){this.element.value=t||0===t?t:""}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function st(t,s,i){const e=new tt(t.locale);return e.set({id:s,ariaDescribedById:i}),e.bind("isReadOnly").to(t,"isEnabled",t=>!t),e.bind("hasError").to(t,"errorText",t=>!!t),e.on("input",()=>{t.errorText=null}),t.bind("isEmpty","isFocused","placeholder").to(e),e}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
class it extends k{constructor(t){super(t);const s=this.locale.t;var i;
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */this.focusTracker=new E,this.keystrokes=new p,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(s("Save"),"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTYuOTcyIDE2LjYxNWEuOTk3Ljk5NyAwIDAgMS0uNzQ0LS4yOTJsLTQuNTk2LTQuNTk2YTEgMSAwIDEgMSAxLjQxNC0xLjQxNGwzLjkyNiAzLjkyNiA5LjkzNy05LjkzN2ExIDEgMCAwIDEgMS40MTQgMS40MTVMNy43MTcgMTYuMzIzYS45OTcuOTk3IDAgMCAxLS43NDUuMjkyeiIvPjwvc3ZnPg==","ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(s("Cancel"),"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTExLjU5MSAxMC4xNzdsNC4yNDMgNC4yNDJhMSAxIDAgMCAxLTEuNDE1IDEuNDE1bC00LjI0Mi00LjI0My00LjI0MyA0LjI0M2ExIDEgMCAwIDEtMS40MTQtMS40MTVsNC4yNDMtNC4yNDJMNC41MiA1LjkzNEExIDEgMCAwIDEgNS45MzQgNC41Mmw0LjI0MyA0LjI0MyA0LjI0Mi00LjI0M2ExIDEgMCAxIDEgMS40MTUgMS40MTRsLTQuMjQzIDQuMjQzeiIvPjwvc3ZnPg==","ck-button-cancel","cancel"),this._focusables=new C,this._focusCycler=new S({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),(i=this).set("_isCssTransitionsDisabled",!1),i.disableCssTransitions=()=>{i._isCssTransitionsDisabled=!0},i.enableCssTransitions=()=>{i._isCssTransitionsDisabled=!1},i.extendTemplate({attributes:{class:[i.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}render(){super.render(),this.keystrokes.listenTo(this.element),function({view:t}){t.listenTo(t.element,"submit",(s,i)=>{i.preventDefault(),t.fire("submit")},{useCapture:!0})}({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)})}_createButton(t,s,i,e){const n=new _(this.locale);return n.set({label:t,icon:s,tooltip:!0}),n.extendTemplate({attributes:{class:i}}),e&&n.delegate("execute").to(this,e),n}_createLabeledInputView(){const t=this.locale.t,s=new X(this.locale,st);return s.label=t("Text alternative"),s}}const et=O("px");class nt extends r{static get pluginName(){return"ContextualBalloon"}constructor(t){super(t),this.positionLimiter=()=>{const t=this.editor.editing.view,s=t.document.selection.editableElement;return s?t.domConverter.mapViewToDom(s.root):null},this.set("visibleView",null),this.view=new v(t.locale),t.ui.view.body.add(this.view),t.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(t){return Array.from(this._viewToStack.keys()).includes(t)}add(t){if(this.hasView(t.view))throw new z("contextualballoon-add-view-exist",[this,t]);const s=t.stackId||"main";if(!this._idToStack.has(s))return this._idToStack.set(s,new Map([[t.view,t]])),this._viewToStack.set(t.view,this._idToStack.get(s)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!t.singleViewMode||this.showStack(s));const i=this._idToStack.get(s);t.singleViewMode&&this.showStack(s),i.set(t.view,t),this._viewToStack.set(t.view,i),i===this._visibleStack&&this._showView(t)}remove(t){if(!this.hasView(t))throw new z("contextualballoon-remove-view-not-exist",[this,t]);const s=this._viewToStack.get(t);this._singleViewMode&&this.visibleView===t&&(this._singleViewMode=!1),this.visibleView===t&&(1===s.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(s.values())[s.size-2])),1===s.size?(this._idToStack.delete(this._getStackId(s)),this._numberOfStacks=this._idToStack.size):s.delete(t),this._viewToStack.delete(t)}updatePosition(t){t&&(this._visibleStack.get(this.visibleView).position=t),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(t){this.visibleStack=t;const s=this._idToStack.get(t);if(!s)throw new z("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==s&&this._showView(Array.from(s.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(t){return Array.from(this._idToStack.entries()).find(s=>s[1]===t)[0]}_showNextStack(){const t=Array.from(this._idToStack.values());let s=t.indexOf(this._visibleStack)+1;t[s]||(s=0),this.showStack(this._getStackId(t[s]))}_showPrevStack(){const t=Array.from(this._idToStack.values());let s=t.indexOf(this._visibleStack)-1;t[s]||(s=t.length-1),this.showStack(this._getStackId(t[s]))}_createRotatorView(){const t=new rt(this.editor.locale),s=this.editor.locale.t;return this.view.content.add(t),t.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(t,s)=>!s&&t>1),t.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),t.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(t,i)=>{if(i<2)return"";const e=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return s("%0 of %1",[e,i])}),t.buttonNextView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),t.buttonPrevView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),t}_createFakePanelsView(){const t=new at(this.editor.locale,this.view);return t.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,s)=>!s&&t>=2?Math.min(t-1,2):0),t.listenTo(this.view,"change:top",()=>t.updatePosition()),t.listenTo(this.view,"change:left",()=>t.updatePosition()),this.editor.ui.view.body.add(t),t}_showView({view:t,balloonClassName:s="",withArrow:i=!0,singleViewMode:e=!1}){this.view.class=s,this.view.withArrow=i,this._rotatorView.showView(t),this.visibleView=t,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),e&&(this._singleViewMode=!0)}_getBalloonPosition(){let t=Array.from(this._visibleStack.values()).pop().position;return t&&!t.limiter&&(t=Object.assign({},t,{limiter:this.positionLimiter})),t}}class rt extends k{constructor(t){super(t);const s=t.t,i=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new E,this.buttonPrevView=this._createButtonView(s("Previous"),"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTExLjQ2MyA1LjE4N2EuODg4Ljg4OCAwIDEgMSAxLjI1NCAxLjI1NUw5LjE2IDEwbDMuNTU3IDMuNTU3YS44ODguODg4IDAgMSAxLTEuMjU0IDEuMjU1TDcuMjYgMTAuNjFhLjg4OC44ODggMCAwIDEgLjE2LTEuMzgybDQuMDQzLTQuMDQyeiIvPjwvc3ZnPg=="),this.buttonNextView=this._createButtonView(s("Next"),"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTguNTM3IDE0LjgxM2EuODg4Ljg4OCAwIDEgMS0xLjI1NC0xLjI1NUwxMC44NCAxMCA3LjI4MyA2LjQ0MmEuODg4Ljg4OCAwIDEgMSAxLjI1NC0xLjI1NUwxMi43NCA5LjM5YS44ODguODg4IDAgMCAxLS4xNiAxLjM4MmwtNC4wNDMgNC4wNDJ6Ii8+PC9zdmc+"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",i.to("isNavigationVisible",t=>t?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(t){this.hideView(),this.content.add(t)}hideView(){this.content.clear()}_createButtonView(t,s){const i=new _(this.locale);return i.set({label:t,icon:s,tooltip:!0}),i}}class at extends k{constructor(t,s){super(t);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=s,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",i.to("numberOfPanels",t=>t?"":"ck-hidden")],style:{top:i.to("top",et),left:i.to("left",et),width:i.to("width",et),height:i.to("height",et)}},children:this.content}),this.on("change:numberOfPanels",(t,s,i,e)=>{i>e?this._addPanels(i-e):this._removePanels(e-i),this.updatePosition()})}_addPanels(t){for(;t--;){const t=new k;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(t){for(;t--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:t,left:s}=this._balloonPanelView,{width:i,height:e}=new y(this._balloonPanelView.element);Object.assign(this,{top:t,left:s,width:i,height:e})}}}function ht(t){const s=t.editing.view,i=v.defaultPositions;return{target:s.domConverter.viewToDom(s.document.selection.getSelectedElement()),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast]}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ot extends r{static get requires(){return[nt]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const t=this.editor,s=t.t;t.ui.componentFactory.add("imageTextAlternative",i=>{const e=t.commands.get("imageTextAlternative"),n=new _(i);return n.set({label:s("Change image text alternative"),icon:"data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMjAgMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTUuMDg1IDYuMjJMMi45NDMgNC4wNzhhLjc1Ljc1IDAgMSAxIDEuMDYtMS4wNmwyLjU5MiAyLjU5QTExLjA5NCAxMS4wOTQgMCAwIDEgMTAgNS4wNjhjNC43MzggMCA4LjU3OCAzLjEwMSA4LjU3OCA1LjA4MyAwIDEuMTk3LTEuNDAxIDIuODAzLTMuNTU1IDMuODg3bDEuNzE0IDEuNzEzYS43NS43NSAwIDAgMS0uMDkgMS4xMzguNDg4LjQ4OCAwIDAgMS0uMTUuMDg0Ljc1Ljc1IDAgMCAxLS44MjEtLjE2TDYuMTcgNy4zMDRjLS4yNTguMTEtLjUxLjIzMy0uNzU3LjM2NWw2LjIzOSA2LjI0LS4wMDYuMDA1Ljc4Ljc4Yy0uMzg4LjA5NC0uNzguMTY2LTEuMTc0LjIxNWwtMS4xMS0xLjExaC4wMTFMNC41NSA4LjE5N2E3LjIgNy4yIDAgMCAwLS42NjUuNTE0bC0uMTEyLjA5OCA0Ljg5NyA0Ljg5Ny0uMDA1LjAwNiAxLjI3NiAxLjI3NmExMC4xNjQgMTAuMTY0IDAgMCAxLTEuNDc3LS4xMTdsLS40NzktLjQ3OS0uMDA5LjAwOS00Ljg2My00Ljg2My0uMDIyLjAzMWEyLjU2MyAyLjU2MyAwIDAgMC0uMTI0LjJjLS4wNDMuMDc3LS4wOC4xNTgtLjEwOC4yNDFhLjUzNC41MzQgMCAwIDAtLjAyOC4xMzMuMjkuMjkgMCAwIDAgLjAwOC4wNzIuOTI3LjkyNyAwIDAgMCAuMDgyLjIyNmMuMDY3LjEzMy4xNDUuMjYuMjM0LjM3OWwzLjI0MiAzLjM2NS4wMjUuMDEuNTkuNjIzYy0zLjI2NS0uOTE4LTUuNTktMy4xNTUtNS41OS00LjY2OCAwLTEuMTk0IDEuNDQ4LTIuODM4IDMuNjYzLTMuOTN6bTcuMDcuNTMxYTQuNjMyIDQuNjMyIDAgMCAxIDEuMTA4IDUuOTkybC4zNDUuMzQ0LjA0Ni0uMDE4YTkuMzEzIDkuMzEzIDAgMCAwIDItMS4xMTJjLjI1Ni0uMTg3LjUtLjM5Mi43MjctLjYxMy4xMzctLjEzNC4yNy0uMjc3LjM5Mi0uNDMxLjA3Mi0uMDkxLjE0MS0uMTg1LjIwMy0uMjg2LjA1Ny0uMDkzLjEwNy0uMTkuMTQ4LS4yOTJhLjcyLjcyIDAgMCAwIC4wMzYtLjEyLjI5LjI5IDAgMCAwIC4wMDgtLjA3Mi40OTIuNDkyIDAgMCAwLS4wMjgtLjEzMy45OTkuOTk5IDAgMCAwLS4wMzYtLjA5NiAyLjE2NSAyLjE2NSAwIDAgMC0uMDcxLS4xNDUgMi45MTcgMi45MTcgMCAwIDAtLjEyNS0uMiAzLjU5MiAzLjU5MiAwIDAgMC0uMjYzLS4zMzUgNS40NDQgNS40NDQgMCAwIDAtLjUzLS41MjMgNy45NTUgNy45NTUgMCAwIDAtMS4wNTQtLjc2OCA5Ljc2NiA5Ljc2NiAwIDAgMC0xLjg3OS0uODkxYy0uMzM3LS4xMTgtLjY4LS4yMTktMS4wMjctLjMwMXptLTIuODUuMjFsLS4wNjkuMDAyYS41MDguNTA4IDAgMCAwLS4yNTQuMDk3LjQ5Ni40OTYgMCAwIDAtLjEwNC42NzkuNDk4LjQ5OCAwIDAgMCAuMzI2LjE5OWwuMDQ1LjAwNWMuMDkxLjAwMy4xODEuMDAzLjI3Mi4wMTJhMi40NSAyLjQ1IDAgMCAxIDIuMDE3IDEuNTEzYy4wMjQuMDYxLjA0My4xMjUuMDY5LjE4NWEuNDk0LjQ5NCAwIDAgMCAuNDUuMjg3aC4wMDhhLjQ5Ni40OTYgMCAwIDAgLjM1LS4xNTguNDgyLjQ4MiAwIDAgMCAuMTMtLjMzNS42MzguNjM4IDAgMCAwLS4wNDgtLjIxOSAzLjM3OSAzLjM3OSAwIDAgMC0uMzYtLjcyMyAzLjQzOCAzLjQzOCAwIDAgMC0yLjc5MS0xLjU0M2wtLjAyOC0uMDAxaC0uMDEzeiIvPjwvc3ZnPg==",tooltip:!0}),n.bind("isEnabled").to(e,"isEnabled"),this.listenTo(n,"execute",()=>{this._showForm()}),n})}_createForm(){const t=this.editor,s=t.editing.view.document;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new it(t.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{t.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(t,s)=>{this._hideForm(!0),s()}),this.listenTo(t.ui,"update",()=>{P(s.selection)?this._isVisible&&
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
function(t){const s=t.plugins.get("ContextualBalloon");if(P(t.editing.view.document.selection)){const i=ht(t);s.updatePosition(i)}}(t):this._hideForm(!0)}),Q({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const t=this.editor,s=t.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:ht(t)}),i.fieldView.value=i.fieldView.element.value=s.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(t){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),t&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ct extends r{static get requires(){return[q,ot]}static get pluginName(){return"ImageTextAlternative"}}
/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */export default class extends r{static get requires(){return[V,R,ct]}static get pluginName(){return"Image"}}